{"remainingRequest":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\components\\InvestmentSummary.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\components\\InvestmentSummary.vue","mtime":1602562396740},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBhcGlTZXJ2aWNlIH0gZnJvbSAiQC9jb21tb24vYXBpLnNlcnZpY2UuanMiOw0KaW1wb3J0IEFkZEludmVzdG1lbnQgZnJvbSAiQC9jb21wb25lbnRzL0FkZEludmVzdG1lbnQudnVlIjsNCmltcG9ydCBJbnZlc3RtZW50RGV0YWlsIGZyb20gIkAvY29tcG9uZW50cy9JbnZlc3RtZW50RGV0YWlsLnZ1ZSI7DQppbXBvcnQgRGVsZXRlT2JqIGZyb20gIkAvY29tcG9uZW50cy9EZWxldGVPYmoudnVlIjsNCmltcG9ydCB7IHJ1bGU0RGlnaXRzLCBydWxlN0RpZ2l0cywgcnVsZVBlcmNlbnRhZ2UgfSBmcm9tICJAL2NvbXBvbmVudHMvbWl4aW5zL1J1bGVzLmpzIjsNCg0KaW1wb3J0IHsNCiAgUExBVEZPUk1fQUFfRkVUQ0gNCn0gZnJvbSAiQC9zdG9yZS9hY3Rpb25zLnR5cGUiOw0KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJJbnZlc3RtZW50U3VtbWFyeSIsDQogIG1peGluczogW3J1bGU0RGlnaXRzLCBydWxlN0RpZ2l0cywgcnVsZVBlcmNlbnRhZ2VdLA0KICBpbmplY3Q6IFsicGxhdGZvcm1JZCIsICJzY2VuYXJpb0lkIl0sDQogIHByb3BzOiB7DQogICAgLy8gT25seSBwYXNzZWQgYXMgYSBwcm9wIHNvIGl0IGNhbiBiZSB3YXRjaGVkIGFuZCBuZXcgaW52ZXN0bWVudHMgY2FsbGVkDQogICAgLy8gd2hlbiB2YWx1ZXMgY2hhbmdlcyAoZHVlIHRvIHBvcnRmb2xpbyBhZGRpdGlvbikNCiAgICBwbGF0Zm9ybVRvdGFsOiB7DQogICAgICB0eXBlOiBOdW1iZXIsDQogICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgIH0NCiAgfSwNCiAgY29tcG9uZW50czogew0KICAgIEFkZEludmVzdG1lbnQsDQogICAgRGVsZXRlT2JqLA0KICAgIEludmVzdG1lbnREZXRhaWwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZXJyb3I6IG51bGwsDQogICAgICBpbnZlc3RtZW50czogW10sDQogICAgICBwb3J0Zm9saW86IHt9LA0KICAgICAgY2hhbmdlTGlzdDogW10sDQogICAgICBpbnZlc3RtZW50Q2xhc3NMaXN0OiBbXSwNCiAgICAgIGVkaXROYW1lOiBbXSwNCiAgICAgIGVkaXRBbW91bnQ6IFtdLA0KICAgICAgZHVwbGljYXRlOiBbXSwNCiAgICB9Ow0KICB9LA0KICB3YXRjaDogew0KICAgIHBsYXRmb3JtVG90YWw6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMuZ2V0SW52ZXN0bWVudERhdGEoKTsNCiAgICB9LA0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcEdldHRlcnMoWyJhY3RpdmVTY2VuYXJpbyIsICJhY3RpdmVQbGF0Zm9ybSJdKSwNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHN0cmluZ1RvQ29sb3VyKHN0cikgew0KICAgICAgbGV0IGhhc2ggPSAwOw0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgaGFzaCA9IHN0ci5jaGFyQ29kZUF0KGkpICsgKChoYXNoIDw8IDUpIC0gaGFzaCk7DQogICAgICB9DQogICAgICBsZXQgY29sb3VyID0gJyMnOw0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHsNCiAgICAgICAgbGV0IHZhbHVlID0gKGhhc2ggPj4gKGkgKiA4KSkgJiAweEZGOw0KICAgICAgICBjb2xvdXIgKz0gKCcwMCcgKyB2YWx1ZS50b1N0cmluZygxNikpLnN1YnN0cigtMik7DQogICAgICB9DQogICAgICByZXR1cm4gY29sb3VyOw0KICAgIH0sDQogICAgZG9OYW1lRWRpdChmaWVsZCwgaW5kZXgsIGV2ZW50LCBpZCl7DQogICAgICBsZXQgaXRlbSA9IHRoaXMuaW52ZXN0bWVudHNbaW5kZXhdLmN1c3RvbV9uYW1lOw0KICAgICAgbGV0IG9yaWdpbmFsID0gdGhpcy5kdXBsaWNhdGUuZmluZCh4ID0+IHguaWQgPT09IGlkKVtmaWVsZF07DQogICAgICBpZiAoKG9yaWdpbmFsID09ICIiKSAmJiAoZmllbGQgPT0gImN1c3RvbV9uYW1lIikpIHsNCiAgICAgICAgb3JpZ2luYWwgPSB0aGlzLmR1cGxpY2F0ZS5maW5kKHggPT4geC5pZCA9PT0gaWQpLm5hbWUubmFtZTsNCiAgICAgIH0NCg0KICAgICAgaXRlbSA9IGV2ZW50Ow0KICAgICAgdGhpcy5pbnZlc3RtZW50c1tpbmRleF0uY3VzdG9tX25hbWUgPSBldmVudDsNCg0KICAgICAgaWYgKHRoaXMuZWRpdE5hbWUuaW5jbHVkZXMoaWQpKSB7DQogICAgICAgIGlmIChpdGVtPT1vcmlnaW5hbCkgew0KICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXROYW1lLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IGlkKTsNCiAgICAgICAgICB0aGlzLmVkaXROYW1lLnNwbGljZShpLDEpDQogICAgICAgIH0NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZWRpdE5hbWUucHVzaChpZCk7DQogICAgICB9DQogICAgfSwNCiAgICBkb0Ftb3VudEVkaXQoZmllbGQsIGluZGV4LCBldmVudCwgaWQpew0KICAgICAgbGV0IGl0ZW0gPSB0aGlzLmludmVzdG1lbnRzW2luZGV4XVtmaWVsZF07DQogICAgICBsZXQgb3JpZ2luYWwgPSB0aGlzLmR1cGxpY2F0ZS5maW5kKHggPT4geC5pZCA9PT0gaWQpW2ZpZWxkXTsNCiAgICAgIGl0ZW0gPSBldmVudC50YXJnZXQudmFsdWU7DQogICAgICBpZiAodGhpcy5lZGl0QW1vdW50LmluY2x1ZGVzKGlkKSkgew0KICAgICAgICAvLyB2LWN1cnJlbmN5LWZpZWxkIGdpdmVzIHRoZSB0YXJnZXQudmFsdWUgYXMgYSBudW1iZXIgd2l0aCBjb21tYXMsDQogICAgICAgIC8vIHNvIGl0IG11c3QgYmUgY29udmVydGVkIHRvIGEgZmxvYXQgdG8gY29tcGFyZSB0byB0aGUgb3JpZ2luYWwuDQogICAgICAgICAgaWYgKHBhcnNlRmxvYXQoaXRlbS5yZXBsYWNlKC8sL2csICcnKSkgPT09IG9yaWdpbmFsKSB7DQogICAgICAgICAgICBjb25zdCBpID0gdGhpcy5lZGl0QW1vdW50LmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IGlkKTsNCiAgICAgICAgICAgIHRoaXMuZWRpdEFtb3VudC5zcGxpY2UoaSwxKQ0KICAgICAgICAgIH0NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZWRpdEFtb3VudC5wdXNoKGlkKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIHJlbW92ZUZyb21FZGl0ZWQoaW52ZXN0bWVudCkgew0KICAgICAgLy9SZW1vdmUgZnJvbSBFZGl0QW1vdW50IExpc3QNCiAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXRBbW91bnQuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5pZCA9PT0gaW52ZXN0bWVudC5pZCk7DQogICAgICB0aGlzLmVkaXRBbW91bnQuc3BsaWNlKGksMSkNCiAgICAgIGNvbnN0IHggPSB0aGlzLmVkaXROYW1lLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IGludmVzdG1lbnQuaWQpOw0KICAgICAgdGhpcy5lZGl0TmFtZS5zcGxpY2UoeCwxKQ0KICAgIH0sDQogICAgZ2V0SW52ZXN0bWVudERhdGEoKSB7DQogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9zY2VuYXJpb3MvJHt0aGlzLnNjZW5hcmlvSWR9L3BsYXRmb3Jtcy8ke3RoaXMucGxhdGZvcm1JZH0vaW52ZXN0bWVudHMvYDsNCiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQpLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIHRoaXMuaW52ZXN0bWVudHMgPSBkYXRhLnJlc3VsdHM7DQogICAgICAgIHRoaXMuZHVwbGljYXRlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmludmVzdG1lbnRzKSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGdldEludmVzdG1lbnRDbGFzc0xpc3QoKSB7DQogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9pbnZlc3RtZW50Y2xhc3MvYDsNCiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsICJHRVQiKS50aGVuKGRhdGEgPT4gew0KICAgICAgICB0aGlzLmludmVzdG1lbnRDbGFzc0xpc3QgPSBkYXRhLnJlc3VsdHM7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGFkZEludmVzdG1lbnQoaW52ZXN0bWVudCkgew0KICAgICAgdGhpcy5pbnZlc3RtZW50cy51bnNoaWZ0KGludmVzdG1lbnQpOw0KICAgICAgdGhpcy5kdXBsaWNhdGUudW5zaGlmdCguLi57aW52ZXN0bWVudH0pOw0KICAgIH0sDQogICAgYWRkUG9ydGZvbGlvKHBvcnRmb2xpbykgew0KICAgICAgdGhpcy5wb3J0Zm9saW8gPSBwb3J0Zm9saW87DQogICAgfSwNCiAgICBkZWxldGVPYmoob2JqZWN0VG9EZWxldGUpIHsNCiAgICAgIHRoaXMuJGRlbGV0ZSh0aGlzLmludmVzdG1lbnRzLCB0aGlzLmludmVzdG1lbnRzLmluZGV4T2Yob2JqZWN0VG9EZWxldGUpKTsNCiAgICB9LA0KICAgIGFkZFRvQ2hhbmdlZChpbnZlc3RtZW50KSB7DQogICAgICBpZiAoISh0aGlzLmNoYW5nZUxpc3QuaW5jbHVkZXMoaW52ZXN0bWVudCkpKSB7DQogICAgICAgIHRoaXMuY2hhbmdlTGlzdC5wdXNoKGludmVzdG1lbnQpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY29uc3QgaSA9IHRoaXMuY2hhbmdlTGlzdC5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLmlkID09PSBpbnZlc3RtZW50LmlkKTsNCiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0LnNwbGljZShpLCAxKTsNCiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0LnB1c2goaW52ZXN0bWVudCk7DQogICAgICB9DQogICAgfSwNCiAgICB1cGRhdGVJbnZlc3RtZW50KGludmVzdG1lbnQpIHsNCiAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL3NjZW5hcmlvcy8ke3RoaXMuc2NlbmFyaW9JZH0vcGxhdGZvcm1zLyR7dGhpcy5wbGF0Zm9ybUlkfS9pbnZlc3RtZW50cy8ke2ludmVzdG1lbnQuaWR9L2A7DQogICAgICBhcGlTZXJ2aWNlKGVuZHBvaW50LCAiUEFUQ0giLCB7DQogICAgICAgIGN1c3RvbV9uYW1lOiBpbnZlc3RtZW50LmN1c3RvbV9uYW1lLA0KICAgICAgICBhbW91bnQ6IGludmVzdG1lbnQuYW1vdW50LA0KICAgICAgfSkudGhlbigoKSA9PiB7DQogICAgICAgIHRoaXMucmVtb3ZlRnJvbUVkaXRlZChpbnZlc3RtZW50KTsNCiAgICAgICAgdGhpcy5nZXRBY3RpdmVQbGF0Zm9ybUFBKCk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIG9uU3VibWl0KCkgew0KICAgICAgaWYgKHRoaXMuY2hhbmdlTGlzdCkgew0KICAgICAgICBmb3IgKGxldCBpPTA7IGkgPCB0aGlzLmNoYW5nZUxpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9zY2VuYXJpb3MvJHt0aGlzLnNjZW5hcmlvSWR9L3BsYXRmb3Jtcy8ke3RoaXMucGxhdGZvcm1JZH0vaW52ZXN0bWVudHMvJHt0aGlzLmNoYW5nZUxpc3RbaV0uaWR9L2A7DQogICAgICAgICAgYXBpU2VydmljZShlbmRwb2ludCwgIlBBVENIIiwgew0KICAgICAgICAgICAgY3VzdG9tX25hbWU6IHRoaXMuY2hhbmdlTGlzdFtpXS5jdXN0b21fbmFtZSwNCiAgICAgICAgICAgIGFtb3VudDogdGhpcy5jaGFuZ2VMaXN0W2ldLmFtb3VudCwNCiAgICAgICAgICB9KS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgIHRoaXMuZ2V0SW52ZXN0bWVudERhdGEoKQ0KICAgICAgICAgICAgdGhpcy5nZXRBY3RpdmVQbGF0Zm9ybUFBKCk7DQogICAgICAgICAgfSk7DQogICAgICAgIH07DQogICAgICB9Ow0KICAgIH0sDQogICAgZ2V0QWN0aXZlUGxhdGZvcm1BQSgpIHsNCiAgICAgIC8vIHJlZnJlc2hlcyB0aGUgcGxhdGZvcm0gYWEgY2hhcnQgd2hlbiBhbiBpbnZlc3RtZW50IGlzIHNhdmVkDQogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaChQTEFURk9STV9BQV9GRVRDSCwgew0KICAgICAgICAnc2NlbmFyaW9JZCc6IHRoaXMuYWN0aXZlU2NlbmFyaW8uaWQsDQogICAgICAgICdwbGF0Zm9ybUlkJzogdGhpcy5hY3RpdmVQbGF0Zm9ybS5pZCwNCiAgICAgIH0pDQogICAgfSwNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmdldEludmVzdG1lbnREYXRhKCk7DQogICAgdGhpcy5nZXRJbnZlc3RtZW50Q2xhc3NMaXN0KCk7DQogIH0NCn07DQo="},{"version":3,"sources":["InvestmentSummary.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"InvestmentSummary.vue","sourceRoot":"src/components","sourcesContent":["<template lang=\"html\">\r\n  <v-form @submit.prevent=\"onSubmit\">\r\n    <v-expansion-panels\r\n      focusable\r\n      multiple>\r\n      <AddInvestment\r\n        @add-investment=\"getInvestmentData\"\r\n        v-on=\"$listeners\" />\r\n\r\n        <v-expansion-panel v-for=\"(investment,index) in investments\"\r\n                :key=\"investment.id\"\r\n                dense>\r\n          <v-expansion-panel-header class=\"pa-3\">\r\n            <v-row class=\"ma-0\">\r\n            <v-col\r\n              @click.stop\r\n              :cols=\"7\"\r\n              class=\"py-0\">\r\n              <v-text-field\r\n                @click.stop\r\n                @change=\"addToChanged(investment)\"\r\n                :value=\"investment.custom_name ? investment.custom_name : investment.name.name\"\r\n                @input=\"doNameEdit('custom_name', index, $event, investment.id)\"\r\n                hide-details=\"auto\"\r\n                dense solo >\r\n                <template\r\n                  v-if=\"editName.includes(investment.id) || editAmount.includes(investment.id)\"\r\n                  v-slot:append-outer>\r\n                    <v-icon\r\n                      color=\"teal\"\r\n                      @click.stop\r\n                      @click=\"updateInvestment(investment)\"\r\n                    >mdi-check-circle-outline</v-icon>\r\n                </template>\r\n              </v-text-field>\r\n            </v-col>\r\n            <v-col\r\n              @click.stop\r\n              :cols=\"3\"  class=\"py-0\">\r\n              <v-currency-field\r\n                @click.stop\r\n                @change=\"addToChanged(investment)\"\r\n                v-model=\"investment.amount\"\r\n                @input.native=\"doAmountEdit('amount', index, $event, investment.id)\"\r\n                hide-details=\"auto\"\r\n                prefix=\"$\"\r\n                :decimal-length=\"0\"\r\n                dense solo />\r\n\r\n            </v-col>\r\n            <v-col :cols=\"2\" class=\"py-0\">\r\n              <DeleteObj\r\n                :objectType=\"'investment'\"\r\n                :objectToDelete=\"investment\"\r\n                :portfolioId=\"investment.portfolio\"\r\n                @delete-object=\"getInvestmentData\"\r\n                v-on=\"$listeners\"\r\n              />\r\n              <v-btn :color=\"stringToColour(investment.platform_fee_group_name)\">\r\n                {{investment.platform_fee_group_name[0]}}\r\n              </v-btn>\r\n            </v-col>\r\n          </v-row>\r\n\r\n        </v-expansion-panel-header>\r\n        <v-expansion-panel-content>\r\n           <InvestmentDetail\r\n             @add-investment=\"getInvestmentData\"\r\n             v-on=\"$listeners\"\r\n             :investment=\"investment\"\r\n             :investmentClassList=\"investmentClassList\"\r\n           />\r\n         </v-expansion-panel-content>\r\n      </v-expansion-panel>\r\n    </v-expansion-panels>\r\n      <v-row v-if=\"investments.length\">\r\n        <v-col>\r\n          <v-btn type=\"submit\" color=\"primary\" dark dense>Update All</v-btn>\r\n        </v-col>\r\n      </v-row>\r\n\r\n\r\n  </v-form>\r\n</template>\r\n\r\n<script>\r\nimport { apiService } from \"@/common/api.service.js\";\r\nimport AddInvestment from \"@/components/AddInvestment.vue\";\r\nimport InvestmentDetail from \"@/components/InvestmentDetail.vue\";\r\nimport DeleteObj from \"@/components/DeleteObj.vue\";\r\nimport { rule4Digits, rule7Digits, rulePercentage } from \"@/components/mixins/Rules.js\";\r\n\r\nimport {\r\n  PLATFORM_AA_FETCH\r\n} from \"@/store/actions.type\";\r\nimport { mapGetters } from \"vuex\";\r\n\r\nexport default {\r\n  name: \"InvestmentSummary\",\r\n  mixins: [rule4Digits, rule7Digits, rulePercentage],\r\n  inject: [\"platformId\", \"scenarioId\"],\r\n  props: {\r\n    // Only passed as a prop so it can be watched and new investments called\r\n    // when values changes (due to portfolio addition)\r\n    platformTotal: {\r\n      type: Number,\r\n      required: true\r\n    }\r\n  },\r\n  components: {\r\n    AddInvestment,\r\n    DeleteObj,\r\n    InvestmentDetail\r\n  },\r\n  data() {\r\n    return {\r\n      error: null,\r\n      investments: [],\r\n      portfolio: {},\r\n      changeList: [],\r\n      investmentClassList: [],\r\n      editName: [],\r\n      editAmount: [],\r\n      duplicate: [],\r\n    };\r\n  },\r\n  watch: {\r\n    platformTotal: function () {\r\n      this.getInvestmentData();\r\n    },\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"activeScenario\", \"activePlatform\"]),\r\n  },\r\n  methods: {\r\n    stringToColour(str) {\r\n      let hash = 0;\r\n      for (let i = 0; i < str.length; i++) {\r\n        hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n      }\r\n      let colour = '#';\r\n      for (let i = 0; i < 3; i++) {\r\n        let value = (hash >> (i * 8)) & 0xFF;\r\n        colour += ('00' + value.toString(16)).substr(-2);\r\n      }\r\n      return colour;\r\n    },\r\n    doNameEdit(field, index, event, id){\r\n      let item = this.investments[index].custom_name;\r\n      let original = this.duplicate.find(x => x.id === id)[field];\r\n      if ((original == \"\") && (field == \"custom_name\")) {\r\n        original = this.duplicate.find(x => x.id === id).name.name;\r\n      }\r\n\r\n      item = event;\r\n      this.investments[index].custom_name = event;\r\n\r\n      if (this.editName.includes(id)) {\r\n        if (item==original) {\r\n          const i = this.editName.findIndex(item => item.id === id);\r\n          this.editName.splice(i,1)\r\n        }\r\n      } else {\r\n        this.editName.push(id);\r\n      }\r\n    },\r\n    doAmountEdit(field, index, event, id){\r\n      let item = this.investments[index][field];\r\n      let original = this.duplicate.find(x => x.id === id)[field];\r\n      item = event.target.value;\r\n      if (this.editAmount.includes(id)) {\r\n        // v-currency-field gives the target.value as a number with commas,\r\n        // so it must be converted to a float to compare to the original.\r\n          if (parseFloat(item.replace(/,/g, '')) === original) {\r\n            const i = this.editAmount.findIndex(item => item.id === id);\r\n            this.editAmount.splice(i,1)\r\n          }\r\n      } else {\r\n        this.editAmount.push(id);\r\n      }\r\n    },\r\n    removeFromEdited(investment) {\r\n      //Remove from EditAmount List\r\n      const i = this.editAmount.findIndex(item => item.id === investment.id);\r\n      this.editAmount.splice(i,1)\r\n      const x = this.editName.findIndex(item => item.id === investment.id);\r\n      this.editName.splice(x,1)\r\n    },\r\n    getInvestmentData() {\r\n      let endpoint = `/api/scenarios/${this.scenarioId}/platforms/${this.platformId}/investments/`;\r\n      apiService(endpoint).then(data => {\r\n        this.investments = data.results;\r\n        this.duplicate = JSON.parse(JSON.stringify(this.investments));\r\n      });\r\n    },\r\n    getInvestmentClassList() {\r\n      let endpoint = `/api/investmentclass/`;\r\n      apiService(endpoint, \"GET\").then(data => {\r\n        this.investmentClassList = data.results;\r\n      });\r\n    },\r\n    addInvestment(investment) {\r\n      this.investments.unshift(investment);\r\n      this.duplicate.unshift(...{investment});\r\n    },\r\n    addPortfolio(portfolio) {\r\n      this.portfolio = portfolio;\r\n    },\r\n    deleteObj(objectToDelete) {\r\n      this.$delete(this.investments, this.investments.indexOf(objectToDelete));\r\n    },\r\n    addToChanged(investment) {\r\n      if (!(this.changeList.includes(investment))) {\r\n        this.changeList.push(investment);\r\n      } else {\r\n        const i = this.changeList.findIndex(item => item.id === investment.id);\r\n        this.changeList.splice(i, 1);\r\n        this.changeList.push(investment);\r\n      }\r\n    },\r\n    updateInvestment(investment) {\r\n      let endpoint = `/api/scenarios/${this.scenarioId}/platforms/${this.platformId}/investments/${investment.id}/`;\r\n      apiService(endpoint, \"PATCH\", {\r\n        custom_name: investment.custom_name,\r\n        amount: investment.amount,\r\n      }).then(() => {\r\n        this.removeFromEdited(investment);\r\n        this.getActivePlatformAA();\r\n      });\r\n    },\r\n    onSubmit() {\r\n      if (this.changeList) {\r\n        for (let i=0; i < this.changeList.length; i++) {\r\n          let endpoint = `/api/scenarios/${this.scenarioId}/platforms/${this.platformId}/investments/${this.changeList[i].id}/`;\r\n          apiService(endpoint, \"PATCH\", {\r\n            custom_name: this.changeList[i].custom_name,\r\n            amount: this.changeList[i].amount,\r\n          }).then(() => {\r\n            this.getInvestmentData()\r\n            this.getActivePlatformAA();\r\n          });\r\n        };\r\n      };\r\n    },\r\n    getActivePlatformAA() {\r\n      // refreshes the platform aa chart when an investment is saved\r\n      this.$store.dispatch(PLATFORM_AA_FETCH, {\r\n        'scenarioId': this.activeScenario.id,\r\n        'platformId': this.activePlatform.id,\r\n      })\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getInvestmentData();\r\n    this.getInvestmentClassList();\r\n  }\r\n};\r\n</script>\r\n"]}]}