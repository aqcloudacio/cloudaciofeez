{"remainingRequest":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\views\\Home.vue","mtime":1601951434894},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGFwaVNlcnZpY2UgfSBmcm9tICJAL2NvbW1vbi9hcGkuc2VydmljZSI7CmltcG9ydCBTY2VuYXJpb1N1bW1hcnkgZnJvbSAiQC9jb21wb25lbnRzL1NjZW5hcmlvU3VtbWFyeS52dWUiOwppbXBvcnQgQWRkU2NlbmFyaW8gZnJvbSAiQC9jb21wb25lbnRzL0FkZFNjZW5hcmlvLnZ1ZSI7CgppbXBvcnQgewogIENMRUFSX0FDVElWRV9TQ0VOQVJJTwp9IGZyb20gIkAvc3RvcmUvbXV0YXRpb25zLnR5cGUiOwppbXBvcnQgewogIEFEVkVSVFNfQUxMCn0gZnJvbSAiQC9zdG9yZS9hY3Rpb25zLnR5cGUiOwppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAidnVleCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImhvbWUiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzY2VuYXJpb3M6IFtdLAogICAgICBuZXh0OiBudWxsLAogICAgICBsb2FkaW5nU2NlbmFyaW9zOiBmYWxzZSwKICAgICAgcmVxdWVzdFVzZXI6IG51bGwsCiAgICAgIG9iamVjdFRvRGVsZXRlOiBudWxsLAogICAgICByaXNrUHJvZmlsZXM6IFtdLAogICAgICBkaWFsb2c6IGZhbHNlLAogICAgICB0aW1lTGltaXQ6IDAsCiAgICAgIHRpbWVNYXg6IDUwMDAsCiAgICAgIGludGVydmFsOiAwLAogICAgICBjbG9zZURpc2FibGVkOiB0cnVlLAogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEFkZFNjZW5hcmlvLAogICAgU2NlbmFyaW9TdW1tYXJ5CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbImFjdGl2ZVVzZXIiLCAiYWR2ZXJ0cyJdKSwKICAgIHNwb25zb3JlZEl0ZW0oKSB7CiAgICAgIGxldCBpdGVtID0gW107CiAgICAgIGl0ZW0gPSB0aGlzLmFkdmVydHMuZmlsdGVyKHggPT4geC50eXBlX25hbWUgPT09ICJwb3BvdmVyIik7CiAgICAgIHJldHVybiBpdGVtWzBdCiAgICB9LAogIH0sCiAgd2F0Y2g6IHsKICAgIGFjdGl2ZVVzZXI6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5nZXRSaXNrUHJvZmlsZXMoKTsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBzZXRSZXF1ZXN0VXNlcigpIHsKICAgICAgdGhpcy5yZXF1ZXN0VXNlciA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiZW1haWwiKTsKICAgIH0sCiAgICBnZXRTY2VuYXJpb3MoKSB7CiAgICAgIGxldCBlbmRwb2ludCA9ICIvYXBpL3NjZW5hcmlvcy8iOwogICAgICBpZiAodGhpcy5uZXh0KSB7CiAgICAgICAgZW5kcG9pbnQgPSB0aGlzLm5leHQ7CiAgICAgIH0KICAgICAgdGhpcy5sb2FkaW5nU2NlbmFyaW9zID0gdHJ1ZTsKICAgICAgYXBpU2VydmljZShlbmRwb2ludCkudGhlbihkYXRhID0+IHsKICAgICAgICB0aGlzLnNjZW5hcmlvcyA9IGRhdGEucmVzdWx0czsKICAgICAgICB0aGlzLmxvYWRpbmdTY2VuYXJpb3MgPSBmYWxzZTsKICAgICAgICBpZiAoZGF0YS5uZXh0KSB7CiAgICAgICAgICB0aGlzLm5leHQgPSBkYXRhLm5leHQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubmV4dCA9IG51bGw7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBnZXRSaXNrUHJvZmlsZXMoKSB7CiAgICAgIGlmICh0aGlzLmFjdGl2ZVVzZXIuYWN0aXZlX3JwKSB7CiAgICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcmlza3Byb2ZpbGVncm91cHMvJHt0aGlzLmFjdGl2ZVVzZXIuYWN0aXZlX3JwfS9yaXNrcHJvZmlsZXMvYDsKICAgICAgICBhcGlTZXJ2aWNlKGVuZHBvaW50KS50aGVuKGRhdGEgPT4gewogICAgICAgICAgdGhpcy5yaXNrUHJvZmlsZXMgPSBkYXRhLnJlc3VsdHM7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBhZGRTY2VuYXJpbyhuZXdTY2VuYXJpbykgewogICAgICB0aGlzLnNjZW5hcmlvcy51bnNoaWZ0KG5ld1NjZW5hcmlvKTsKICAgIH0sCiAgICBnZXRBZHZlcnRzKCkgewogICAgICBpZiAodGhpcy5fLmlzRW1wdHkodGhpcy5hZHZlcnRzKSkgewogICAgICAvLyBHZXRzIHRoZSBhZCBpbmZvIHRoZW4gY2FsbHMgdGhlIHBvcG92ZXIgbW9kYWwuCiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goQURWRVJUU19BTEwpLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy5sb2FkTW9kYWwoKTsKICAgICAgICB9KQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubG9hZE1vZGFsKCk7CiAgICAgIH0KICAgIH0sCiAgICBsb2FkTW9kYWwoKSB7CiAgICAgIHRoaXMuc3RhcnRUaW1lcigpOwogICAgICB2YXIgbmV4dFBvcHVwID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oICduZXh0TW9kYWxBZCcgKTsKCiAgICAgIGlmIChuZXh0UG9wdXAgPiBuZXcgRGF0ZSgpKSB7CiAgICAgICAgdGhpcy5kaWFsb2cgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmRpYWxvZyA9IHRydWU7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgLy8gU3RvcmUgdGhlIGV4cGlyYXRpb24gZGF0ZSBvZiB0aGUgY3VycmVudCBwb3B1cCBpbiBsb2NhbFN0b3JhZ2UuCgkJICAgICAgdmFyIGV4cGlyZXMgPSBuZXcgRGF0ZSgpOwoJCSAgICAgIGV4cGlyZXMgPSBleHBpcmVzLnNldEhvdXJzKGV4cGlyZXMuZ2V0SG91cnMoKSArIDI0KTsKCQkgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSggJ25leHRNb2RhbEFkJywgZXhwaXJlcyApOwogICAgICAgICAgdGhpcy5jbG9zZURpc2FibGVkID0gZmFsc2U7CiAgICAgICAgfSwgdGhpcy50aW1lTWF4KTsKICAgICAgfQogICAgfSwKICAgIHN0YXJ0VGltZXIoKSB7CiAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHsKCiAgICAgICAgaWYgKHRoaXMudGltZUxpbWl0IDwgMTAwKSB7CiAgICAgICAgICB0aGlzLnRpbWVMaW1pdCArPSAwLjU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCkKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0uYmluZCh0aGlzKSwgMjUpOwogICAgfSwKICAgIGNsZWFyQWN0aXZlU2NlbmFyaW8oKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdChDTEVBUl9BQ1RJVkVfU0NFTkFSSU8pOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0Umlza1Byb2ZpbGVzKCk7CiAgICB0aGlzLnNldFJlcXVlc3RVc2VyKCk7CiAgICB0aGlzLmdldFNjZW5hcmlvcygpOwogICAgdGhpcy5nZXRBZHZlcnRzKCk7CiAgICB0aGlzLmNsZWFyQWN0aXZlU2NlbmFyaW8oKTsKICAgIGRvY3VtZW50LnRpdGxlID0gIlByb2R1Y3RSZXgiOwogIH0KfTsK"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <v-container class=\"pa-0\">\n    <AddScenario\n      v-if=\"activeUser\"\n      :riskProfiles=\"riskProfiles\"\n      @add-scenario=\"addScenario\" />\n    <v-spacer><br>\n    </v-spacer>\n    <ScenarioSummary\n      v-if=\"activeUser\"\n      :scenarios=\"scenarios\"\n      :riskProfiles=\"riskProfiles\" />\n    <v-dialog\n      v-if=\"sponsoredItem\"\n      persistent\n      max-width=\"700px\"\n      v-model=\"dialog\">\n      <v-card>\n        <v-img :src=\"sponsoredItem.image\">\n        </v-img>\n        <v-card-subtitle class=\"pa-0\" align=\"end\">\n          Sponsored Content\n        </v-card-subtitle>\n      </v-card>\n      <v-btn @click=\"dialog=false\" :href=\"sponsoredItem.link\" target=\"_blank\">\n        Tell me more\n      </v-btn>\n      <v-btn @click=\"dialog=false\" :disabled=\"closeDisabled\">\n        Close\n      </v-btn>\n      <v-progress-linear\n        class=\"modal-progress\"\n        :buffer-value=\"100\"\n        :value=\"timeLimit\">\n      </v-progress-linear>\n    </v-dialog>\n  </v-container>\n</template>\n\n<script>\nimport { apiService } from \"@/common/api.service\";\nimport ScenarioSummary from \"@/components/ScenarioSummary.vue\";\nimport AddScenario from \"@/components/AddScenario.vue\";\n\nimport {\n  CLEAR_ACTIVE_SCENARIO\n} from \"@/store/mutations.type\";\nimport {\n  ADVERTS_ALL\n} from \"@/store/actions.type\";\nimport { mapGetters } from \"vuex\";\n\nexport default {\n  name: \"home\",\n  data() {\n    return {\n      scenarios: [],\n      next: null,\n      loadingScenarios: false,\n      requestUser: null,\n      objectToDelete: null,\n      riskProfiles: [],\n      dialog: false,\n      timeLimit: 0,\n      timeMax: 5000,\n      interval: 0,\n      closeDisabled: true,\n    };\n  },\n  components: {\n    AddScenario,\n    ScenarioSummary\n  },\n  computed: {\n    ...mapGetters([\"activeUser\", \"adverts\"]),\n    sponsoredItem() {\n      let item = [];\n      item = this.adverts.filter(x => x.type_name === \"popover\");\n      return item[0]\n    },\n  },\n  watch: {\n    activeUser: function () {\n      this.getRiskProfiles();\n    },\n  },\n  methods: {\n    setRequestUser() {\n      this.requestUser = window.localStorage.getItem(\"email\");\n    },\n    getScenarios() {\n      let endpoint = \"/api/scenarios/\";\n      if (this.next) {\n        endpoint = this.next;\n      }\n      this.loadingScenarios = true;\n      apiService(endpoint).then(data => {\n        this.scenarios = data.results;\n        this.loadingScenarios = false;\n        if (data.next) {\n          this.next = data.next;\n        } else {\n          this.next = null;\n        }\n      });\n    },\n    getRiskProfiles() {\n      if (this.activeUser.active_rp) {\n        let endpoint = `/api/riskprofilegroups/${this.activeUser.active_rp}/riskprofiles/`;\n        apiService(endpoint).then(data => {\n          this.riskProfiles = data.results;\n        });\n      }\n    },\n    addScenario(newScenario) {\n      this.scenarios.unshift(newScenario);\n    },\n    getAdverts() {\n      if (this._.isEmpty(this.adverts)) {\n      // Gets the ad info then calls the popover modal.\n        this.$store.dispatch(ADVERTS_ALL).then(() => {\n          this.loadModal();\n        })\n      } else {\n        this.loadModal();\n      }\n    },\n    loadModal() {\n      this.startTimer();\n      var nextPopup = localStorage.getItem( 'nextModalAd' );\n\n      if (nextPopup > new Date()) {\n        this.dialog = false;\n      } else {\n        this.dialog = true;\n        window.setTimeout(() => {\n          // Store the expiration date of the current popup in localStorage.\n\t\t      var expires = new Date();\n\t\t      expires = expires.setHours(expires.getHours() + 24);\n\t\t      localStorage.setItem( 'nextModalAd', expires );\n          this.closeDisabled = false;\n        }, this.timeMax);\n      }\n    },\n    startTimer() {\n      this.interval = setInterval(function() {\n\n        if (this.timeLimit < 100) {\n          this.timeLimit += 0.5;\n        } else {\n          clearInterval(this.interval)\n          return;\n        }\n      }.bind(this), 25);\n    },\n    clearActiveScenario() {\n      this.$store.commit(CLEAR_ACTIVE_SCENARIO);\n    }\n  },\n  mounted() {\n    this.getRiskProfiles();\n    this.setRequestUser();\n    this.getScenarios();\n    this.getAdverts();\n    this.clearActiveScenario();\n    document.title = \"ProductRex\";\n  }\n};\n</script>\n<style media=\"screen\">\n  .modal-progress {\n   transition: none !important\n  }\n</style>\n"]}]}