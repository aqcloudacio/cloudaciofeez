{"remainingRequest":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\components\\PortfolioTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\components\\PortfolioTable.vue","mtime":1585284820258},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBhcGlTZXJ2aWNlIH0gZnJvbSAiQC9jb21tb24vYXBpLnNlcnZpY2UuanMiOw0KaW1wb3J0IERlbGV0ZU9iaiBmcm9tICJAL2NvbXBvbmVudHMvRGVsZXRlT2JqLnZ1ZSI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIlBvcnRmb2xpb1RhYmxlIiwNCiAgcHJvcHM6IHsNCiAgICBwb3J0Zm9saW9JRDogew0KICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgcmVxdWlyZWQ6IGZhbHNlLA0KICAgIH0sDQogICAgcG9ydGZvbGlvOiB7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgICByZXF1aXJlZDogZmFsc2UsDQogICAgfSwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgaW52ZXN0bWVudHM6IFtdLA0KICAgICAgZXJyb3I6IG51bGwsDQogICAgICBjaGFuZ2VMaXN0OiBbXSwNCiAgICAgIGludmVzdG1lbnRMaXN0OiBbXSwNCiAgICAgIG5ld0ludmVzdG1lbnQ6IHt9LA0KICAgIH07DQogIH0sDQogIGNvbXBvbmVudHM6IHsNCiAgICBEZWxldGVPYmosDQogIH0sDQogIHdhdGNoOiB7DQogICAgcG9ydGZvbGlvOiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLmdldEludmVzdG1lbnRMaXN0KCk7DQogICAgICB0aGlzLmdldEludmVzdG1lbnRzKCk7DQogICAgfSwNCiAgICBwb3J0Zm9saW9JRDogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy5nZXRJbnZlc3RtZW50TGlzdCgpOw0KICAgICAgdGhpcy5nZXRJbnZlc3RtZW50cygpOw0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldFBvcnRmb2xpb0lEKCkgew0KICAgICAgaWYgKHRoaXMucG9ydGZvbGlvSUQgIT0gbnVsbCkgew0KICAgICAgICByZXR1cm4gdGhpcy5wb3J0Zm9saW9JRDsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB0aGlzLnBvcnRmb2xpby5pZDsNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldEludmVzdG1lbnRMaXN0KCkgew0KICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvaW52ZXN0bWVudG5hbWUvYDsNCiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsICJHRVQiKS50aGVuKGRhdGEgPT4gew0KICAgICAgICB0aGlzLmludmVzdG1lbnRMaXN0ID0gZGF0YS5yZXN1bHRzOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBhZGRUb0NoYW5nZWQoaW52ZXN0bWVudCkgew0KICAgICAgaWYgKCEodGhpcy5jaGFuZ2VMaXN0LmluY2x1ZGVzKGludmVzdG1lbnQpKSkgew0KICAgICAgICB0aGlzLmNoYW5nZUxpc3QucHVzaChpbnZlc3RtZW50KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnN0IGkgPSB0aGlzLmNoYW5nZUxpc3QuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5pZCA9PT0gaW52ZXN0bWVudC5pZCk7DQogICAgICAgIHRoaXMuY2hhbmdlTGlzdC5zcGxpY2UoaSwgMSk7DQogICAgICAgIHRoaXMuY2hhbmdlTGlzdC5wdXNoKGludmVzdG1lbnQpOw0KICAgICAgfQ0KICAgIH0sDQogICAgZ2V0SW52ZXN0bWVudHMoKSB7DQogICAgICBpZiAodGhpcy5nZXRQb3J0Zm9saW9JRCgpICE9IG51bGwpIHsNCiAgICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcG9ydGZvbGlvdGVtcGxhdGVzLyR7dGhpcy5nZXRQb3J0Zm9saW9JRCgpfS9pbnZlc3RtZW50cy9gOw0KICAgICAgICBhcGlTZXJ2aWNlKGVuZHBvaW50KS50aGVuKGRhdGEgPT4gew0KICAgICAgICAgIHRoaXMuaW52ZXN0bWVudHMgPSBkYXRhLnJlc3VsdHM7DQogICAgICAgIH0pOw0KICAgICAgfTsNCiAgICB9LA0KICAgIGFkZEludmVzdG1lbnQoKSB7DQogICAgICBpZiAodGhpcy5uZXdJbnZlc3RtZW50LmludmVzdG1lbnRfbmFtZSkgew0KICAgICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9wb3J0Zm9saW90ZW1wbGF0ZXMvJHt0aGlzLmdldFBvcnRmb2xpb0lEKCl9L2ludmVzdG1lbnRzL2A7DQogICAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsICJQT1NUIiwgew0KICAgICAgICAgIGludmVzdG1lbnRfbmFtZV9pZDogdGhpcy5uZXdJbnZlc3RtZW50LmludmVzdG1lbnRfbmFtZSwNCiAgICAgICAgICBwb3J0Zm9saW86IHRoaXMuZ2V0UG9ydGZvbGlvSUQoKSwNCiAgICAgICAgICBwZXJjZW50YWdlOiB0aGlzLm5ld0ludmVzdG1lbnQucGVyY2VudGFnZSwNCiAgICAgICAgfSkudGhlbihkYXRhID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsNCiAgICAgICAgICB0aGlzLmdldEludmVzdG1lbnRMaXN0KCk7DQogICAgICAgICAgdGhpcy5nZXRJbnZlc3RtZW50cygpOw0KICAgICAgICAgIHRoaXMubmV3SW52ZXN0bWVudC5pbnZlc3RtZW50X25hbWUgPSBudWxsOw0KICAgICAgICAgIHRoaXMubmV3SW52ZXN0bWVudC5wZXJjZW50YWdlID0gbnVsbDsNCiAgICAgICAgICB9KTsNCiAgICAgICAgaWYgKHRoaXMuZXJyb3IpIHsNCiAgICAgICAgICB0aGlzLmVycm9yID0gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5lcnJvciA9ICJZb3UgbXVzdCBlbnRlciBhIG5hbWUgYW5kIGFtb3VudCBmb3IgdGhlIG5ldyBpbnZlc3RtZW50IjsNCiAgICAgIH0NCiAgICB9LA0KICAgIG9uU3VibWl0KCkgew0KICAgICAgaWYgKHRoaXMuY2hhbmdlTGlzdCkgew0KICAgICAgICBmb3IgKGxldCBpPTA7IGkgPCB0aGlzLmNoYW5nZUxpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9wb3J0Zm9saW90ZW1wbGF0ZXMvJHt0aGlzLmdldFBvcnRmb2xpb0lEKCl9L2ludmVzdG1lbnRzLyR7dGhpcy5jaGFuZ2VMaXN0W2ldLmlkfS9gOw0KICAgICAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsICJQQVRDSCIsIHsNCiAgICAgICAgICAgIGludmVzdG1lbnRfbmFtZV9pZDogdGhpcy5jaGFuZ2VMaXN0W2ldLmludmVzdG1lbnRfbmFtZS5pZCwNCiAgICAgICAgICAgIHBvcnRmb2xpbzogdGhpcy5nZXRQb3J0Zm9saW9JRCgpLA0KICAgICAgICAgICAgcGVyY2VudGFnZTogdGhpcy5jaGFuZ2VMaXN0W2ldLnBlcmNlbnRhZ2UsDQogICAgICAgICAgfSkudGhlbihkYXRhID0+IHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOw0KICAgICAgICAgIH0pOw0KICAgICAgICB9Ow0KICAgICAgfTsNCiAgICB9LA0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuZ2V0SW52ZXN0bWVudExpc3QoKTsNCiAgICB0aGlzLmdldEludmVzdG1lbnRzKCk7DQogIH0NCn07DQo="},{"version":3,"sources":["PortfolioTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PortfolioTable.vue","sourceRoot":"src/components","sourcesContent":["<template lang=\"html\">\r\n  <v-form  @submit.prevent=\"onSubmit\">\r\n    <v-container v-if=\"portfolioID || portfolio\">\r\n      <v-row dense>\r\n        <v-col\r\n        :cols=\"8\">\r\n          <v-card>\r\n            <v-card-title>\r\n              Description\r\n            </v-card-title>\r\n          </v-card>\r\n        </v-col>\r\n        <v-col\r\n          :cols=\"3\">\r\n          <v-card>\r\n            <v-card-title>\r\n              Percentage\r\n            </v-card-title>\r\n          </v-card>\r\n        </v-col>\r\n        <v-col\r\n          :cols=\"1\">\r\n        </v-col>\r\n      </v-row>\r\n      <v-row\r\n        v-for=\"investment in investments\"\r\n        :key=\"investment.id\"\r\n        dense>\r\n        <v-col\r\n          :cols=\"8\">\r\n            <v-autocomplete\r\n              v-model=\"investment.investment_name\"\r\n              :items=\"investmentList\"\r\n              item-text=\"name\"\r\n              item-value=\"id\"\r\n              @change=\"addToChanged(investment)\"\r\n              outlined dense solo/>\r\n        </v-col>\r\n        <v-col\r\n          :cols=\"3\">\r\n            <v-text-field\r\n              @change=\"addToChanged(investment)\"\r\n              v-model=\"investment.percentage\"\r\n              dense solo/>\r\n        </v-col>\r\n        <v-col\r\n          :cols=\"1\">\r\n          <DeleteObj\r\n            :objectType=\"'modelInvestment'\"\r\n            :objectToDelete=\"investment\"\r\n            :portfolioID=\"getPortfolioID()\"\r\n            @delete-object=\"getInvestments()\"\r\n            v-on=\"$listeners\"\r\n          />\r\n        </v-col>\r\n      </v-row>\r\n      <v-row\r\n        dense>\r\n        <v-col\r\n          :cols=\"8\">\r\n          <v-autocomplete\r\n            v-model=\"newInvestment.investment_name\"\r\n            :items=\"investmentList\"\r\n            item-text=\"name\"\r\n            item-value=\"id\"\r\n            outlined dense solo\r\n            label=\"Add an investment by typing a name\"/>\r\n        </v-col>\r\n        <v-col\r\n          :cols=\"3\">\r\n            <v-text-field\r\n              v-model=\"newInvestment.percentage\"\r\n              outlined dense solo/>\r\n        </v-col>\r\n        <v-col\r\n          :cols=\"1\">\r\n          <v-btn type=\"button\" color=\"green\" dark dense\r\n            @click=\"addInvestment\">\r\n            <v-icon>\r\n              mdi-plus\r\n            </v-icon>\r\n          </v-btn>\r\n        </v-col>\r\n      </v-row>\r\n      <v-row v-if=\"investments.length\">\r\n        <v-col>\r\n          <v-btn type=\"submit\" color=\"primary\" dark dense>Update</v-btn>\r\n        </v-col>\r\n      </v-row>\r\n      <br>\r\n    </v-container>\r\n  </v-form>\r\n</template>\r\n\r\n<script>\r\nimport { apiService } from \"@/common/api.service.js\";\r\nimport DeleteObj from \"@/components/DeleteObj.vue\";\r\n\r\nexport default {\r\n  name: \"PortfolioTable\",\r\n  props: {\r\n    portfolioID: {\r\n      type: Number,\r\n      required: false,\r\n    },\r\n    portfolio: {\r\n      type: Object,\r\n      required: false,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      investments: [],\r\n      error: null,\r\n      changeList: [],\r\n      investmentList: [],\r\n      newInvestment: {},\r\n    };\r\n  },\r\n  components: {\r\n    DeleteObj,\r\n  },\r\n  watch: {\r\n    portfolio: function () {\r\n      this.getInvestmentList();\r\n      this.getInvestments();\r\n    },\r\n    portfolioID: function () {\r\n      this.getInvestmentList();\r\n      this.getInvestments();\r\n    }\r\n  },\r\n  methods: {\r\n    getPortfolioID() {\r\n      if (this.portfolioID != null) {\r\n        return this.portfolioID;\r\n      } else {\r\n        return this.portfolio.id;\r\n      }\r\n    },\r\n    getInvestmentList() {\r\n      let endpoint = `/api/investmentname/`;\r\n      apiService(endpoint, \"GET\").then(data => {\r\n        this.investmentList = data.results;\r\n      });\r\n    },\r\n    addToChanged(investment) {\r\n      if (!(this.changeList.includes(investment))) {\r\n        this.changeList.push(investment);\r\n      } else {\r\n        const i = this.changeList.findIndex(item => item.id === investment.id);\r\n        this.changeList.splice(i, 1);\r\n        this.changeList.push(investment);\r\n      }\r\n    },\r\n    getInvestments() {\r\n      if (this.getPortfolioID() != null) {\r\n        let endpoint = `/api/portfoliotemplates/${this.getPortfolioID()}/investments/`;\r\n        apiService(endpoint).then(data => {\r\n          this.investments = data.results;\r\n        });\r\n      };\r\n    },\r\n    addInvestment() {\r\n      if (this.newInvestment.investment_name) {\r\n        let endpoint = `/api/portfoliotemplates/${this.getPortfolioID()}/investments/`;\r\n        apiService(endpoint, \"POST\", {\r\n          investment_name_id: this.newInvestment.investment_name,\r\n          portfolio: this.getPortfolioID(),\r\n          percentage: this.newInvestment.percentage,\r\n        }).then(data => {\r\n          console.log(data);\r\n          this.getInvestmentList();\r\n          this.getInvestments();\r\n          this.newInvestment.investment_name = null;\r\n          this.newInvestment.percentage = null;\r\n          });\r\n        if (this.error) {\r\n          this.error = null;\r\n        }\r\n      } else {\r\n        this.error = \"You must enter a name and amount for the new investment\";\r\n      }\r\n    },\r\n    onSubmit() {\r\n      if (this.changeList) {\r\n        for (let i=0; i < this.changeList.length; i++) {\r\n          let endpoint = `/api/portfoliotemplates/${this.getPortfolioID()}/investments/${this.changeList[i].id}/`;\r\n          apiService(endpoint, \"PATCH\", {\r\n            investment_name_id: this.changeList[i].investment_name.id,\r\n            portfolio: this.getPortfolioID(),\r\n            percentage: this.changeList[i].percentage,\r\n          }).then(data => {\r\n            console.log(data);\r\n          });\r\n        };\r\n      };\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getInvestmentList();\r\n    this.getInvestments();\r\n  }\r\n};\r\n</script>\r\n"]}]}