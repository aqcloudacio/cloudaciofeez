{"remainingRequest":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\views\\Platform.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\views\\Platform.vue","mtime":1610415409393},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBhcGlTZXJ2aWNlIH0gZnJvbSAiQC9jb21tb24vYXBpLnNlcnZpY2UuanMiOw0KaW1wb3J0IFBsYXRmb3JtRGV0YWlsIGZyb20gIkAvY29tcG9uZW50cy9QbGF0Zm9ybURldGFpbC52dWUiOw0KaW1wb3J0IEludmVzdG1lbnRTdW1tYXJ5IGZyb20gIkAvY29tcG9uZW50cy9JbnZlc3RtZW50U3VtbWFyeS52dWUiOw0KaW1wb3J0IFBsYXRmb3JtQUFDaGFydFN1bW1hcnkgZnJvbSAiQC9jb21wb25lbnRzL1BsYXRmb3JtQUFDaGFydFN1bW1hcnkudnVlIjsNCmltcG9ydCB7DQogIENMRUFSX0FDVElWRV9QTEFURk9STSwNCiAgQ0xFQVJfQUNUSVZFX1NDRU5BUklPLA0KICBDTEVBUl9BQ1RJVkVfUExBVEZPUk1fQUEsDQp9IGZyb20gIkAvc3RvcmUvbXV0YXRpb25zLnR5cGUiOw0KaW1wb3J0IHsNCiAgU0NFTkFSSU9fRkVUQ0gsDQogIFBMQVRGT1JNX0ZFVENILA0KICBQTEFURk9STV9BQV9GRVRDSCwNCiAgUExBVEZPUk1OQU1FX0FMTCwNCn0gZnJvbSAiQC9zdG9yZS9hY3Rpb25zLnR5cGUiOw0KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOw0KDQoNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiUGxhdGZvcm0iLA0KICBwcm92aWRlKCkgew0KICAgIHJldHVybiB7DQogICAgICBwbGF0Zm9ybUlkOiB0aGlzLmlkLA0KICAgICAgc2NlbmFyaW9JZDogdGhpcy5zY2VuYXJpb0lkDQogICAgfTsNCiAgfSwNCiAgcHJvcHM6IHsNCiAgICBzY2VuYXJpb0lkOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgIH0sDQogICAgaWQ6IHsNCiAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBBQUNoYXJ0S2V5OiAwLA0KICAgICAgcGxhdGZvcm06IHt9LA0KICAgICAgcGxhdGZvcm1GZWVzOiBbXSwNCiAgICAgIGVycm9yOiBudWxsLA0KICAgIH07DQogIH0sDQogIGNvbXBvbmVudHM6IHsNCiAgICBJbnZlc3RtZW50U3VtbWFyeSwNCiAgICBQbGF0Zm9ybURldGFpbCwNCiAgICBQbGF0Zm9ybUFBQ2hhcnRTdW1tYXJ5LA0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcEdldHRlcnMoWyJhY3RpdmVTY2VuYXJpbyIsICJhY3RpdmVVc2VyIiwgImFjdGl2ZVBsYXRmb3JtIl0pLA0KICB9LA0KICB3YXRjaDogew0KICAgIGFjdGl2ZVNjZW5hcmlvKCkgew0KICAgICAgLy8gSW4gY2FzZSBhY3RpdmVTY2VuYXJpbyBuZWVkcyB0byBiZSBmZXRjaGVkIGFuZCBpcyBzbG93DQogICAgICB0aGlzLmdldEFjdGl2ZVBsYXRmb3JtQUEoKQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldFBsYXRmb3JtRmVlRGF0YSgpIHsNCiAgICAgIGlmICh0aGlzLl8uaXNFbXB0eSh0aGlzLnBsYXRmb3JtRmVlcykpIHsNCiAgICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvc2NlbmFyaW9zLyR7dGhpcy5zY2VuYXJpb0lkfS9wbGF0Zm9ybXMvJHt0aGlzLmlkfS9wbGF0Zm9ybWZlZXMvYDsNCiAgICAgICAgYXBpU2VydmljZShlbmRwb2ludCkudGhlbihkYXRhID0+IHsNCiAgICAgICAgICB0aGlzLnBsYXRmb3JtRmVlcyA9IGRhdGEucmVzdWx0czsNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICBzZXRBY3RpdmVTY2VuYXJpbygpew0KICAgICAgaWYgKHRoaXMuXy5pc0VtcHR5KHRoaXMuYWN0aXZlU2NlbmFyaW8pKSB7DQogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKFNDRU5BUklPX0ZFVENILCB0aGlzLnNjZW5hcmlvSWQpOw0KICAgICAgfQ0KICAgIH0sDQogICAgc2V0QWN0aXZlUGxhdGZvcm0oKXsNCiAgICAgIGlmICh0aGlzLl8uaXNFbXB0eSh0aGlzLmFjdGl2ZVBsYXRmb3JtKSkgew0KICAgICAgICB0aGlzLmdldEFjdGl2ZVBsYXRmb3JtKCk7DQogICAgICB9DQogICAgfSwNCiAgICBnZXRBY3RpdmVQbGF0Zm9ybSgpIHsNCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKFBMQVRGT1JNX0ZFVENILCB7DQogICAgICAgICdzY2VuYXJpb0lkJzogdGhpcy5zY2VuYXJpb0lkLA0KICAgICAgICAncGxhdGZvcm1JZCc6IHRoaXMuaWQNCiAgICAgIH0pLnRoZW4oKCkgPT4gew0KICAgICAgICB0aGlzLmdldFBsYXRmb3JtRmVlRGF0YSgpOw0KICAgICAgICB0aGlzLnNldEFjdGl2ZVBsYXRmb3JtQUEoKTsNCiAgICAgIH0pDQogICAgfSwNCiAgICBzZXRBY3RpdmVQbGF0Zm9ybUFBKCl7DQogICAgICBpZiAodGhpcy5fLmlzRW1wdHkodGhpcy5hY3RpdmVQbGF0Zm9ybUFBKSkgew0KICAgICAgICB0aGlzLmdldEFjdGl2ZVBsYXRmb3JtQUEoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldEFjdGl2ZVBsYXRmb3JtQUEoKSB7DQogICAgICAvLyBXYWl0cyB1bnRpbCBhY3RpdmVTY2VuYXJpbyBhbmQgYWN0aXZlUGxhdGZvcm0gaGF2ZSBiZWVuIGZldGNoZWQNCiAgICAgIGlmICghdGhpcy5fLmlzRW1wdHkodGhpcy5hY3RpdmVTY2VuYXJpbykgJiYgIXRoaXMuXy5pc0VtcHR5KHRoaXMuYWN0aXZlUGxhdGZvcm0pKSB7DQogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKFBMQVRGT1JNX0FBX0ZFVENILCB7DQogICAgICAgICAgJ3NjZW5hcmlvSWQnOiB0aGlzLmFjdGl2ZVNjZW5hcmlvLmlkLA0KICAgICAgICAgICdwbGF0Zm9ybUlkJzogdGhpcy5hY3RpdmVQbGF0Zm9ybS5pZCwNCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldFBsYXRmb3JtTmFtZXMoKSB7DQogICAgICBpZiAodGhpcy5fLmlzRW1wdHkodGhpcy5wbGF0Zm9ybU5hbWVzKSkgew0KICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaChQTEFURk9STU5BTUVfQUxMLCBudWxsKQ0KICAgICAgfQ0KICAgIH0sDQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5zZXRBY3RpdmVTY2VuYXJpbygpOw0KICAgIHRoaXMuc2V0QWN0aXZlUGxhdGZvcm0oKTsNCiAgICB0aGlzLmdldFBsYXRmb3JtRmVlRGF0YSgpOw0KICAgIHRoaXMuc2V0QWN0aXZlUGxhdGZvcm1BQSgpOw0KICAgIHRoaXMuZ2V0UGxhdGZvcm1OYW1lcygpOw0KICB9LA0KICBiZWZvcmVEZXN0cm95KCkgew0KICAgIHRoaXMuJHN0b3JlLmNvbW1pdChDTEVBUl9BQ1RJVkVfUExBVEZPUk0pOw0KICAgIHRoaXMuJHN0b3JlLmNvbW1pdChDTEVBUl9BQ1RJVkVfUExBVEZPUk1fQUEpOw0KICB9LA0KICBiZWZvcmVSb3V0ZUxlYXZlKHRvLCBmcm9tLCBuZXh0KSB7DQogICAgaWYgKHRvLm5hbWUgIT0gInNjZW5hcmlvIikgew0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KENMRUFSX0FDVElWRV9TQ0VOQVJJTyk7DQogICAgfQ0KICAgIG5leHQoKQ0KICB9DQp9Ow0K"},{"version":3,"sources":["Platform.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Platform.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <v-container class=\"fullwidthrow pa-0\" style=\"background: #e4e7f0\">\r\n      <v-container style=\"width:1012px\" class=\"pb-0\">\r\n        <v-card v-if=\"!_.isEmpty(activePlatform)\"  class=\"pa-8 mt-4 rounded-card-top-only nobottomshadow\">\r\n        <PlatformDetail\r\n          :platformFees=\"platformFees\"\r\n          @add-portfolio=\"getActivePlatform\"\r\n          @modify-fees=\"getActivePlatform\"\r\n        />\r\n        <PlatformAAChartSummary\r\n          v-if=\"!_.isEmpty(activePlatform) && !_.isEmpty(activeScenario)\"\r\n          />\r\n        </v-card>\r\n      </v-container>\r\n    </v-container>\r\n    <v-container\r\n      class=\"white px-4 pt-0\">\r\n      <v-card class=\"rounded-card px-4 py-4\" color=\"#f1f3f7\">\r\n        <InvestmentSummary\r\n          v-if=\"!_.isEmpty(activePlatform)\"\r\n          @delete-object=\"getActivePlatform\"\r\n          :platformTotal=\"activePlatform.platform_total\"\r\n        />\r\n      </v-card>\r\n    </v-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { apiService } from \"@/common/api.service.js\";\r\nimport PlatformDetail from \"@/components/PlatformDetail.vue\";\r\nimport InvestmentSummary from \"@/components/InvestmentSummary.vue\";\r\nimport PlatformAAChartSummary from \"@/components/PlatformAAChartSummary.vue\";\r\nimport {\r\n  CLEAR_ACTIVE_PLATFORM,\r\n  CLEAR_ACTIVE_SCENARIO,\r\n  CLEAR_ACTIVE_PLATFORM_AA,\r\n} from \"@/store/mutations.type\";\r\nimport {\r\n  SCENARIO_FETCH,\r\n  PLATFORM_FETCH,\r\n  PLATFORM_AA_FETCH,\r\n  PLATFORMNAME_ALL,\r\n} from \"@/store/actions.type\";\r\nimport { mapGetters } from \"vuex\";\r\n\r\n\r\n\r\nexport default {\r\n  name: \"Platform\",\r\n  provide() {\r\n    return {\r\n      platformId: this.id,\r\n      scenarioId: this.scenarioId\r\n    };\r\n  },\r\n  props: {\r\n    scenarioId: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    id: {\r\n      type: Number,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      AAChartKey: 0,\r\n      platform: {},\r\n      platformFees: [],\r\n      error: null,\r\n    };\r\n  },\r\n  components: {\r\n    InvestmentSummary,\r\n    PlatformDetail,\r\n    PlatformAAChartSummary,\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"activeScenario\", \"activeUser\", \"activePlatform\"]),\r\n  },\r\n  watch: {\r\n    activeScenario() {\r\n      // In case activeScenario needs to be fetched and is slow\r\n      this.getActivePlatformAA()\r\n    }\r\n  },\r\n  methods: {\r\n    getPlatformFeeData() {\r\n      if (this._.isEmpty(this.platformFees)) {\r\n        let endpoint = `/api/scenarios/${this.scenarioId}/platforms/${this.id}/platformfees/`;\r\n        apiService(endpoint).then(data => {\r\n          this.platformFees = data.results;\r\n        });\r\n      }\r\n    },\r\n    setActiveScenario(){\r\n      if (this._.isEmpty(this.activeScenario)) {\r\n        this.$store.dispatch(SCENARIO_FETCH, this.scenarioId);\r\n      }\r\n    },\r\n    setActivePlatform(){\r\n      if (this._.isEmpty(this.activePlatform)) {\r\n        this.getActivePlatform();\r\n      }\r\n    },\r\n    getActivePlatform() {\r\n      this.$store.dispatch(PLATFORM_FETCH, {\r\n        'scenarioId': this.scenarioId,\r\n        'platformId': this.id\r\n      }).then(() => {\r\n        this.getPlatformFeeData();\r\n        this.setActivePlatformAA();\r\n      })\r\n    },\r\n    setActivePlatformAA(){\r\n      if (this._.isEmpty(this.activePlatformAA)) {\r\n        this.getActivePlatformAA();\r\n      }\r\n    },\r\n    getActivePlatformAA() {\r\n      // Waits until activeScenario and activePlatform have been fetched\r\n      if (!this._.isEmpty(this.activeScenario) && !this._.isEmpty(this.activePlatform)) {\r\n        this.$store.dispatch(PLATFORM_AA_FETCH, {\r\n          'scenarioId': this.activeScenario.id,\r\n          'platformId': this.activePlatform.id,\r\n        })\r\n      }\r\n    },\r\n    getPlatformNames() {\r\n      if (this._.isEmpty(this.platformNames)) {\r\n        this.$store.dispatch(PLATFORMNAME_ALL, null)\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.setActiveScenario();\r\n    this.setActivePlatform();\r\n    this.getPlatformFeeData();\r\n    this.setActivePlatformAA();\r\n    this.getPlatformNames();\r\n  },\r\n  beforeDestroy() {\r\n    this.$store.commit(CLEAR_ACTIVE_PLATFORM);\r\n    this.$store.commit(CLEAR_ACTIVE_PLATFORM_AA);\r\n  },\r\n  beforeRouteLeave(to, from, next) {\r\n    if (to.name != \"scenario\") {\r\n      this.$store.commit(CLEAR_ACTIVE_SCENARIO);\r\n    }\r\n    next()\r\n  }\r\n};\r\n</script>\r\n"]}]}