{"remainingRequest":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\components\\Notifications.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\components\\Notifications.vue","mtime":1605847775111},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBhcGlTZXJ2aWNlIH0gZnJvbSAiQC9jb21tb24vYXBpLnNlcnZpY2UuanMiOw0KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOw0KaW1wb3J0IHsNCiAgUFJBQ1RJQ0VfSU5WSVRFX0FDQ0VQVA0KfSBmcm9tICJAL3N0b3JlL2FjdGlvbnMudHlwZSI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgcHJvcHM6IHsNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgbm90aWZpY2F0aW9uczogbnVsbCwNCiAgICAgIGFjdGl2ZV9wcmFjdGljZTogdHJ1ZSwNCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwR2V0dGVycyhbImFjdGl2ZVVzZXIiXSksDQogICAgdmlzaWJsZU5vdGlmaWNhdGlvbnMoKSB7DQogICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zKSB7DQogICAgICAgIHJldHVybiB0aGlzLm5vdGlmaWNhdGlvbnMuZmlsdGVyKGkgPT4gaS52aXNpYmxlID09IHRydWUpDQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gW10NCiAgICAgIH0NCiAgICB9LA0KICAgIGxhc3RUaHJlZU5vdGlmaWNhdGlvbnMoKSB7DQogICAgICByZXR1cm4gdGhpcy52aXNpYmxlTm90aWZpY2F0aW9ucy5zbGljZSgwLDMpDQogICAgfSwNCiAgICB1bnJlYWROb3RpZmljYXRpb25zKCkgew0KICAgICAgcmV0dXJuIHRoaXMudmlzaWJsZU5vdGlmaWNhdGlvbnMuZmlsdGVyKGkgPT4gaS5yZWFkID09IGZhbHNlKQ0KICAgIH0sDQogICAgbnVtTm90aWZpY2F0aW9ucygpIHsNCiAgICAgIGlmICh0aGlzLnVucmVhZE5vdGlmaWNhdGlvbnMubGVuZ3RoID4gMCkgew0KICAgICAgICByZXR1cm4gdGhpcy51bnJlYWROb3RpZmljYXRpb25zLmxlbmd0aA0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIG51bGwNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXROb3RpZmljYXRpb25zKCkgew0KICAgICAgbGV0IGVuZHBvaW50ID0gIi9hcGkvbm90aWZpY2F0aW9ucy8iOw0KICAgICAgYXBpU2VydmljZShlbmRwb2ludCkudGhlbihkYXRhID0+IHsNCiAgICAgICAgdGhpcy5ub3RpZmljYXRpb25zID0gZGF0YS5yZXN1bHRzOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBkZW55Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbil7DQogICAgICB0aGlzLnNldEludmlzaWJsZShub3RpZmljYXRpb24pDQogICAgfSwNCiAgICBhY2NlcHROb3RpZmljYXRpb24obm90aWZpY2F0aW9uKSB7DQogICAgICB0aGlzLnNldEludmlzaWJsZShub3RpZmljYXRpb24pOw0KICAgICAgaWYgKG5vdGlmaWNhdGlvbi50eXBlID09ICdwcmFjdGljZV9pbnZpdGUnKXsNCiAgICAgICAgdGhpcy5hY2NlcHRQcmFjdGljZUludml0ZShub3RpZmljYXRpb24pOw0KICAgICAgfQ0KICAgIH0sDQogICAgYWNjZXB0UHJhY3RpY2VJbnZpdGUobm90aWZpY2F0aW9uKSB7DQogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaChQUkFDVElDRV9JTlZJVEVfQUNDRVBULCBub3RpZmljYXRpb24pDQogICAgfSwNCiAgICBzZXRBc1JlYWQoKSB7DQogICAgICBsZXQgaWRzID0gW10NCiAgICAgIGZvciAobGV0IGl0ZW0gb2YgdGhpcy51bnJlYWROb3RpZmljYXRpb25zKSB7DQogICAgICAgIGlkcy5wdXNoKGl0ZW0uaWQpOw0KICAgICAgfQ0KICAgICAgZm9yIChsZXQgaWQgb2YgaWRzKSB7DQogICAgICAgIGxldCByZXN1bHQgPSB0aGlzLm5vdGlmaWNhdGlvbnMuZmluZChpID0+IGkuaWQgPT09IGlkKQ0KICAgICAgICByZXN1bHQucmVhZCA9IHRydWU7DQogICAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL25vdGlmaWNhdGlvbnMvJHtpZH0vYDsNCiAgICAgICAgYXBpU2VydmljZShlbmRwb2ludCwgIlBBVENIIiwgew0KICAgICAgICAgIHJlYWQ6IHRydWUsDQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQogICAgc2V0SW52aXNpYmxlKG5vdGlmaWNhdGlvbikgew0KICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvbm90aWZpY2F0aW9ucy8ke25vdGlmaWNhdGlvbi5pZH0vYDsNCiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsICJQQVRDSCIsIHsNCiAgICAgICAgdmlzaWJsZTogZmFsc2UsDQogICAgICB9KS50aGVuKGRhdGEgPT4gew0KICAgICAgICB0aGlzLiRzZXQobm90aWZpY2F0aW9uLCd2aXNpYmxlJywgZGF0YS52aXNpYmxlKTsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmdldE5vdGlmaWNhdGlvbnMoKTsNCiAgfQ0KfQ0K"},{"version":3,"sources":["Notifications.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Notifications.vue","sourceRoot":"src/components","sourcesContent":["<template lang=\"html\">\r\n  <v-menu\r\n    :close-on-content-click=\"false\"\r\n    offset-y\r\n    max-width=\"400px\"\r\n    >\r\n    <template v-slot:activator=\"{ on }\">\r\n      <v-btn class=\"ml-6\" small icon v-on=\"on\" @click=\"setAsRead\">\r\n        <v-badge\r\n          :value=\"numNotifications != null\"\r\n          :content=\"numNotifications\"\r\n          overlap >\r\n          <v-icon >mdi-bell-outline</v-icon>\r\n        </v-badge>\r\n      </v-btn>\r\n    </template>\r\n    <v-card>\r\n      <template\r\n        v-for=\"(notification,index) in lastThreeNotifications\">\r\n        <v-container :key=\"notification.id\" class=\"pa-0\">\r\n          <v-list three-line class=\"pb-0\">\r\n            <v-list-item>\r\n              <v-list-item-content >\r\n                <v-list-item-title>{{notification.title}}</v-list-item-title>\r\n                <v-list-item-subtitle>{{notification.content}}</v-list-item-subtitle>\r\n              </v-list-item-content>\r\n            </v-list-item>\r\n          </v-list>\r\n          <template v-if=\"notification.type==='practice_invite'\">\r\n            <v-list  class=\"pa-0\">\r\n              <v-list-item  >\r\n                <v-list-item-action>\r\n                  <v-switch v-model=\"notification.active_practice\" color=\"teal\"></v-switch>\r\n                </v-list-item-action>\r\n                <v-list-item-title>Set as active practice</v-list-item-title>\r\n              </v-list-item>\r\n            </v-list>\r\n            <v-card-actions>\r\n              <v-spacer />\r\n              <v-btn text @click=\"denyNotification(notification)\">Ignore</v-btn>\r\n              <v-btn color=\"primary\" text @click=\"acceptNotification(notification)\">Accept Invitation</v-btn>\r\n            </v-card-actions>\r\n          </template>\r\n          <template v-if=\"notification.type=='scenario_share'\">\r\n            <v-card-actions>\r\n              <v-spacer />\r\n              <v-btn text @click=\"denyNotification(notification)\">Got it</v-btn>\r\n            </v-card-actions>\r\n          </template>\r\n          <v-divider v-if=\"index < (notifications.length-1)\" />\r\n        </v-container>\r\n      </template>\r\n    </v-card>\r\n  </v-menu>\r\n</template>\r\n\r\n<script>\r\nimport { apiService } from \"@/common/api.service.js\";\r\nimport { mapGetters } from \"vuex\";\r\nimport {\r\n  PRACTICE_INVITE_ACCEPT\r\n} from \"@/store/actions.type\";\r\n\r\nexport default {\r\n  props: {\r\n  },\r\n  data() {\r\n    return {\r\n      notifications: null,\r\n      active_practice: true,\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"activeUser\"]),\r\n    visibleNotifications() {\r\n      if (this.notifications) {\r\n        return this.notifications.filter(i => i.visible == true)\r\n      } else {\r\n        return []\r\n      }\r\n    },\r\n    lastThreeNotifications() {\r\n      return this.visibleNotifications.slice(0,3)\r\n    },\r\n    unreadNotifications() {\r\n      return this.visibleNotifications.filter(i => i.read == false)\r\n    },\r\n    numNotifications() {\r\n      if (this.unreadNotifications.length > 0) {\r\n        return this.unreadNotifications.length\r\n      } else {\r\n        return null\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    getNotifications() {\r\n      let endpoint = \"/api/notifications/\";\r\n      apiService(endpoint).then(data => {\r\n        this.notifications = data.results;\r\n      });\r\n    },\r\n    denyNotification(notification){\r\n      this.setInvisible(notification)\r\n    },\r\n    acceptNotification(notification) {\r\n      this.setInvisible(notification);\r\n      if (notification.type == 'practice_invite'){\r\n        this.acceptPracticeInvite(notification);\r\n      }\r\n    },\r\n    acceptPracticeInvite(notification) {\r\n      this.$store.dispatch(PRACTICE_INVITE_ACCEPT, notification)\r\n    },\r\n    setAsRead() {\r\n      let ids = []\r\n      for (let item of this.unreadNotifications) {\r\n        ids.push(item.id);\r\n      }\r\n      for (let id of ids) {\r\n        let result = this.notifications.find(i => i.id === id)\r\n        result.read = true;\r\n        let endpoint = `/api/notifications/${id}/`;\r\n        apiService(endpoint, \"PATCH\", {\r\n          read: true,\r\n        });\r\n      }\r\n    },\r\n    setInvisible(notification) {\r\n      let endpoint = `/api/notifications/${notification.id}/`;\r\n      apiService(endpoint, \"PATCH\", {\r\n        visible: false,\r\n      }).then(data => {\r\n        this.$set(notification,'visible', data.visible);\r\n      });\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getNotifications();\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"css\" scoped>\r\n</style>\r\n"]}]}