{"remainingRequest":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\components\\DeleteStaff.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\components\\DeleteStaff.vue","mtime":1590642826583},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBhcGlTZXJ2aWNlIH0gZnJvbSAiQC9jb21tb24vYXBpLnNlcnZpY2UuanMiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiRGVsZXRlU3RhZmYiLA0KICBwcm9wczogew0KICAgIHN0YWZmOiB7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgIH0sDQogICAgcHJhY3RpY2U6IHsNCiAgICAgIHR5cGU6IE9iamVjdCwNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBlcnJvcjogbnVsbCwNCiAgICAgIGRpYWxvZzogZmFsc2UsDQogICAgfTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBlbWFpbE9yTmFtZSgpIHsNCiAgICAgIGlmICh0aGlzLnByYWN0aWNlLnBlbmRpbmdfc3RhZmYuaW5jbHVkZXModGhpcy5zdGFmZikpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuc3RhZmYuZW1haWwNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGlmICh0aGlzLnN0YWZmLm5hbWUgIT0gbnVsbCkgew0KICAgICAgICAgIHJldHVybiB0aGlzLnN0YWZmLm5hbWUNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXR1cm4gdGhpcy5zdGFmZi5lbWFpbA0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGZpbmRTdGFmZkluZGV4KGFycmF5LCBzdGFmZikgew0KICAgICAgcmV0dXJuIHRoaXMucHJhY3RpY2VbYXJyYXldLmZpbmRJbmRleChpID0+IGkuaWQgPT09IHN0YWZmLmlkKTsNCiAgICB9LA0KICAgIHJlbW92ZUZyb21BcnJheShhcnJheSxpbmRleCkgew0KICAgICAgaWYgKGluZGV4ICE9IC0xKSB7DQogICAgICB0aGlzLnByYWN0aWNlW2FycmF5XS5zcGxpY2UoaW5kZXgsMSk7DQogICAgICB9DQogICAgfSwNCiAgICBkZWxldGVTdGFmZihzdGFmZikgew0KICAgICAgbGV0IGFycmF5cyA9IFsnc3RhZmYnLCdhZG1pbnMnLCdwZW5kaW5nX3N0YWZmJ107DQogICAgICBmb3IgKGxldCBhcnJheSBvZiBhcnJheXMpIHsNCiAgICAgICAgdGhpcy5yZW1vdmVGcm9tQXJyYXkoYXJyYXksdGhpcy5maW5kU3RhZmZJbmRleChhcnJheSxzdGFmZikpOw0KICAgICAgfQ0KDQogICAgICBsZXQgc3RhZmZBcnJheSA9IHRoaXMucHJhY3RpY2Uuc3RhZmYubWFwKGZ1bmN0aW9uIChvYmopIHsNCiAgICAgICAgcmV0dXJuIG9iai5pZCB9KQ0KDQogICAgICBsZXQgYWRtaW5BcnJheSA9IHRoaXMucHJhY3RpY2UuYWRtaW5zLm1hcChmdW5jdGlvbiAob2JqKSB7DQogICAgICAgIHJldHVybiBvYmouaWQgfSkNCg0KICAgICAgbGV0IHBlbmRpbmdTdGFmZkFycmF5ID0gdGhpcy5wcmFjdGljZS5wZW5kaW5nX3N0YWZmLm1hcChmdW5jdGlvbiAob2JqKSB7DQogICAgICAgIHJldHVybiBvYmouaWQgfSkNCg0KICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcHJhY3RpY2VzLyR7dGhpcy5wcmFjdGljZS5pZH0vYDsNCiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsICJQQVRDSCIsIHsNCiAgICAgICAgYWRtaW5zX2lkOiBhZG1pbkFycmF5LA0KICAgICAgICBzdGFmZl9pZDogc3RhZmZBcnJheSwNCiAgICAgICAgcGVuZGluZ19zdGFmZl9pZDogcGVuZGluZ1N0YWZmQXJyYXksDQogICAgICB9KS50aGVuKGRhdGEgPT4gew0KICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsNCiAgICAgICAgdGhpcy51bnNldEFjdGl2ZShzdGFmZikNCiAgICAgIH0pDQogICAgICB0aGlzLmRpYWxvZyA9IGZhbHNlOw0KICAgIH0sDQogICAgdW5zZXRBY3RpdmUoc3RhZmYpIHsNCiAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL3VzZXIvJHtzdGFmZi5pZH0vYDsNCiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsICJQQVRDSCIgLCB7DQogICAgICAgIC8vIEVtcHR5IGNhbGwgdG8gdXNlciBBUEkgd2hpY2ggd2lsbCB0cmlnZ2VyIGEgVXNlciBzaWduYWwgdG8gcmVtb3ZlDQogICAgICAgIC8vIGFjdGl2ZV9wcmFjdGljZSBhbmQgYWN0aXZlX3JwIGlmIG5lZWRlZA0KICAgICAgfSkNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["DeleteStaff.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DeleteStaff.vue","sourceRoot":"src/components","sourcesContent":["<!-- This is a generic component that deletes the object that is passed in, then\r\npasses back the object so it can be removed from the displayed array. -->\r\n\r\n<template>\r\n  <v-dialog v-model=\"dialog\" max-width=\"290\">\r\n    <template v-slot:activator=\"{ on }\">\r\n      <v-list-item v-on=\"on\">\r\n        <v-list-item-title>\r\n          Remove from practice\r\n        </v-list-item-title>\r\n      </v-list-item>\r\n    </template>\r\n    <v-container>\r\n      <v-card>\r\n        <v-card-text>\r\n          Are you sure you want to remove {{emailOrName}}\r\n          from your practice? <br> <br>\r\n          They will lose access to shared clients\r\n          and your practice will retain access to those clients.\r\n        </v-card-text>\r\n        <v-btn @click=\"deleteStaff(staff)\">\r\n          Yes\r\n        </v-btn>\r\n        <v-btn @click=\"dialog = false\">\r\n          No\r\n        </v-btn>\r\n      </v-card>\r\n    </v-container>\r\n  </v-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { apiService } from \"@/common/api.service.js\";\r\nexport default {\r\n  name: \"DeleteStaff\",\r\n  props: {\r\n    staff: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    practice: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      error: null,\r\n      dialog: false,\r\n    };\r\n  },\r\n  computed: {\r\n    emailOrName() {\r\n      if (this.practice.pending_staff.includes(this.staff)) {\r\n        return this.staff.email\r\n      } else {\r\n        if (this.staff.name != null) {\r\n          return this.staff.name\r\n        } else {\r\n          return this.staff.email\r\n        }\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    findStaffIndex(array, staff) {\r\n      return this.practice[array].findIndex(i => i.id === staff.id);\r\n    },\r\n    removeFromArray(array,index) {\r\n      if (index != -1) {\r\n      this.practice[array].splice(index,1);\r\n      }\r\n    },\r\n    deleteStaff(staff) {\r\n      let arrays = ['staff','admins','pending_staff'];\r\n      for (let array of arrays) {\r\n        this.removeFromArray(array,this.findStaffIndex(array,staff));\r\n      }\r\n\r\n      let staffArray = this.practice.staff.map(function (obj) {\r\n        return obj.id })\r\n\r\n      let adminArray = this.practice.admins.map(function (obj) {\r\n        return obj.id })\r\n\r\n      let pendingStaffArray = this.practice.pending_staff.map(function (obj) {\r\n        return obj.id })\r\n\r\n      let endpoint = `/api/practices/${this.practice.id}/`;\r\n      apiService(endpoint, \"PATCH\", {\r\n        admins_id: adminArray,\r\n        staff_id: staffArray,\r\n        pending_staff_id: pendingStaffArray,\r\n      }).then(data => {\r\n        console.log(data);\r\n        this.unsetActive(staff)\r\n      })\r\n      this.dialog = false;\r\n    },\r\n    unsetActive(staff) {\r\n      let endpoint = `/api/user/${staff.id}/`;\r\n      apiService(endpoint, \"PATCH\" , {\r\n        // Empty call to user API which will trigger a User signal to remove\r\n        // active_practice and active_rp if needed\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}