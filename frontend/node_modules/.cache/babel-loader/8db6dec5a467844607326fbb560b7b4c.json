{"remainingRequest":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\common\\api.service.js","dependencies":[{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\src\\common\\api.service.js","mtime":1603946033757},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Feez\\feez\\frontend\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCB7IENTUkZfVE9LRU4gfSBmcm9tICIuL2NzcmZfdG9rZW4uanMiOwppbXBvcnQgdXNlciBmcm9tICIuLi9zdG9yZS91c2VyLm1vZHVsZSI7CmltcG9ydCBzdG9yZSBmcm9tICIuLi9zdG9yZS9pbmRleCI7CmltcG9ydCB7IFJFRlJFU0hfQUNDRVNTX1RPS0VOIH0gZnJvbSAiLi4vc3RvcmUvYWN0aW9ucy50eXBlIjsKaW1wb3J0IHsgU0VUX1JFRlJFU0hJTkdfSU5fUFJPR1JFU1MgfSBmcm9tICIuLi9zdG9yZS9tdXRhdGlvbnMudHlwZSI7CgpmdW5jdGlvbiBoYW5kbGVSZXNwb25zZShyZXNwb25zZSkgewogIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwNCkgewogICAgcmV0dXJuICIiOwogIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgIC8vIFByZXZlbnRzIG11dGxpcGxlIHNpbXVsdGFuZW91cyByZWZyZXNoZXMKICAgIGlmICghdXNlci5zdGF0ZS5yZWZyZXNoaW5nSW5Qcm9ncmVzcykgewogICAgICBjb25zb2xlLmxvZygncmVxdWVzdGluZyB0b2tlbiByZWZyZXNoJyk7CiAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgc3RvcmUuY29tbWl0KFNFVF9SRUZSRVNISU5HX0lOX1BST0dSRVNTLCBzdG9yZS5kaXNwYXRjaChSRUZSRVNIX0FDQ0VTU19UT0tFTikpOwogICAgfSBlbHNlIHsKICAgICAgY29uc29sZS5sb2coJ2Jsb2NrZWQuIHRva2VuIHJlcXVlc3QgaW4gcHJvZ3Jlc3MnKTsKICAgIH0KICB9IGVsc2UgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKS50aGVuKGZ1bmN0aW9uIChqc29uKSB7CiAgICAgIHJldHVybiByZXNwb25zZS5vayA/IGpzb24gOiBQcm9taXNlLnJlamVjdChqc29uKTsKICAgIH0pOwogIH0KfQoKZnVuY3Rpb24gYXBpU2VydmljZShlbmRwb2ludCwgbWV0aG9kLCBkYXRhKSB7CiAgdmFyIGNvbmZpZyA9IHsKICAgIG1ldGhvZDogbWV0aG9kIHx8ICJHRVQiLAogICAgYm9keTogZGF0YSAhPT0gdW5kZWZpbmVkID8gSlNPTi5zdHJpbmdpZnkoZGF0YSkgOiBudWxsLAogICAgaGVhZGVyczogewogICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAiWC1DU1JGVE9LRU4iOiBDU1JGX1RPS0VOLAogICAgICAiQXV0aG9yaXphdGlvbiI6ICJCZWFyZXIgIi5jb25jYXQodXNlci5zdGF0ZS5hY2Nlc3NUb2tlbikKICAgIH0KICB9OwogIHJldHVybiBmZXRjaChlbmRwb2ludCwgY29uZmlnKS50aGVuKGhhbmRsZVJlc3BvbnNlKTsKfQoKZXhwb3J0IHsgYXBpU2VydmljZSB9OwpleHBvcnQgdmFyIFNjZW5hcmlvU2VydmljZSA9IHsKICAvLyBsaXN0KCkgewogIC8vICAgcmV0dXJuIGFwaVNlcnZpY2UoYC9hcGkvc2NlbmFyaW9zL2AsICJHRVQiKTsKICAvLyB9LAogIGdldDogZnVuY3Rpb24gZ2V0KHNjZW5hcmlvSWQpIHsKICAgIHJldHVybiBhcGlTZXJ2aWNlKCIvYXBpL3NjZW5hcmlvcy8iLmNvbmNhdChzY2VuYXJpb0lkLCAiLyIpLCAiR0VUIik7CiAgfSwKICBjcmVhdGU6IGZ1bmN0aW9uIGNyZWF0ZShzY2VuYXJpbykgewogICAgcmV0dXJuIGFwaVNlcnZpY2UoIi9hcGkvc2NlbmFyaW9zLyIsICJQT1NUIiwgc2NlbmFyaW8pOwogIH0sCiAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoc2NlbmFyaW8pIHsKICAgIHJldHVybiBhcGlTZXJ2aWNlKCIvYXBpL3NjZW5hcmlvcy8iLmNvbmNhdChzY2VuYXJpby5pZCwgIi8iKSwgIlBBVENIIiwgc2NlbmFyaW8pOwogIH0gLy8gZGVzdHJveShzY2VuYXJpb0lkKSB7CiAgLy8gICByZXR1cm4gYXBpU2VydmljZShgL2FwaS9zY2VuYXJpb3MvJHtzY2VuYXJpb0lkfS9gLCAiREVMRVRFIik7CiAgLy8gfQoKfTsKZXhwb3J0IHZhciBBZHZlcnRTZXJ2aWNlID0gewogIGxpc3Q6IGZ1bmN0aW9uIGxpc3QoKSB7CiAgICByZXR1cm4gYXBpU2VydmljZSgiL2FwaS9jdXJyZW50YWR2ZXJ0LyIsICJHRVQiKTsKICB9Cn07CmV4cG9ydCB2YXIgSW52ZXN0bWVudE5hbWVTZXJ2aWNlID0gewogIGxpc3Q6IGZ1bmN0aW9uIGxpc3QoKSB7CiAgICByZXR1cm4gYXBpU2VydmljZSgiL2FwaS91bmxpbmtlZGludmVzdG1lbnRuYW1lLyIsICJHRVQiKTsKICB9Cn07CmV4cG9ydCB2YXIgUGxhdGZvcm1TZXJ2aWNlID0gewogIGdldDogZnVuY3Rpb24gZ2V0KF9yZWYpIHsKICAgIHZhciBzY2VuYXJpb0lkID0gX3JlZi5zY2VuYXJpb0lkLAogICAgICAgIHBsYXRmb3JtSWQgPSBfcmVmLnBsYXRmb3JtSWQ7CiAgICByZXR1cm4gYXBpU2VydmljZSgiL2FwaS9zY2VuYXJpb3MvIi5jb25jYXQoc2NlbmFyaW9JZCwgIi9wbGF0Zm9ybXMvIikuY29uY2F0KHBsYXRmb3JtSWQsICIvIiksICJHRVQiKTsKICB9LAogIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKHN0YXRlLCByb290U3RhdGUpIHsKICAgIHJldHVybiBhcGlTZXJ2aWNlKCIvYXBpL3NjZW5hcmlvcy8iLmNvbmNhdChyb290U3RhdGUuc2NlbmFyaW8uYWN0aXZlU2NlbmFyaW8uaWQsICIvcGxhdGZvcm1zLyIpLmNvbmNhdChzdGF0ZS5hY3RpdmVQbGF0Zm9ybS5pZCwgIi8iKSwgIlBBVENIIiwgc3RhdGUuYWN0aXZlUGxhdGZvcm0pOwogIH0KfTsKZXhwb3J0IHZhciBQbGF0Zm9ybUFBU2VydmljZSA9IHsKICBsaXN0OiBmdW5jdGlvbiBsaXN0KF9yZWYyKSB7CiAgICB2YXIgc2NlbmFyaW9JZCA9IF9yZWYyLnNjZW5hcmlvSWQsCiAgICAgICAgcGxhdGZvcm1JZCA9IF9yZWYyLnBsYXRmb3JtSWQ7CiAgICByZXR1cm4gYXBpU2VydmljZSgiL2FwaS9zY2VuYXJpb3MvIi5jb25jYXQoc2NlbmFyaW9JZCwgIi9wbGF0Zm9ybXMvIikuY29uY2F0KHBsYXRmb3JtSWQsICIvYWFzdW1tYXJ5LyIpLCAiR0VUIik7CiAgfQp9OwpleHBvcnQgdmFyIFBsYXRmb3JtTmFtZVNlcnZpY2UgPSB7CiAgbGlzdDogZnVuY3Rpb24gbGlzdChlbmRwb2ludCkgewogICAgaWYgKGVuZHBvaW50KSB7CiAgICAgIHJldHVybiBhcGlTZXJ2aWNlKGVuZHBvaW50LCAiR0VUIik7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gYXBpU2VydmljZSgiL2FwaS9wbGF0Zm9ybW5hbWVzLyIsICJHRVQiKTsKICAgIH0KICB9Cn07CmV4cG9ydCB2YXIgVXNlclNlcnZpY2UgPSB7CiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICByZXR1cm4gYXBpU2VydmljZSgiL2FwaS91c2VyLyIsICJHRVQiKTsKICB9LAogIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKHVzZXIpIHsKICAgIHJldHVybiBhcGlTZXJ2aWNlKCIvYXBpL3VzZXIvIi5jb25jYXQodXNlci5pZCwgIi8iKSwgIlBBVENIIiwgdXNlcik7CiAgfSwKICBsb2dpbjogZnVuY3Rpb24gbG9naW4oY3JlZGVudGlhbHMpIHsKICAgIHJldHVybiBhcGlTZXJ2aWNlKCIvYXBpL3Rva2VuLyIsICJQT1NUIiwgY3JlZGVudGlhbHMpOwogIH0sCiAgcmVmcmVzaFRva2VuOiBmdW5jdGlvbiByZWZyZXNoVG9rZW4oX3JlZnJlc2hUb2tlbikgewogICAgY29uc29sZS5sb2coJ3Rva2VuIHJlZnJlc2hpbmcuLicpOwogICAgcmV0dXJuIGFwaVNlcnZpY2UoIi9hcGkvdG9rZW4vcmVmcmVzaC8iLCAiUE9TVCIsIF9yZWZyZXNoVG9rZW4pOwogIH0KfTs="},{"version":3,"sources":["C:/Users/User/Desktop/Feez/feez/frontend/src/common/api.service.js"],"names":["CSRF_TOKEN","user","store","REFRESH_ACCESS_TOKEN","SET_REFRESHING_IN_PROGRESS","handleResponse","response","status","state","refreshingInProgress","console","log","commit","dispatch","json","then","ok","Promise","reject","apiService","endpoint","method","data","config","body","undefined","JSON","stringify","headers","accessToken","fetch","ScenarioService","get","scenarioId","create","scenario","update","id","AdvertService","list","InvestmentNameService","PlatformService","platformId","rootState","activeScenario","activePlatform","PlatformAAService","PlatformNameService","UserService","login","credentials","refreshToken"],"mappings":"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","sourcesContent":["import { CSRF_TOKEN } from \"./csrf_token.js\";\r\nimport user from \"../store/user.module\";\r\nimport store from \"../store/index\";\r\nimport {\r\n  REFRESH_ACCESS_TOKEN,\r\n} from \"../store/actions.type\";\r\nimport {\r\n  SET_REFRESHING_IN_PROGRESS,\r\n} from \"../store/mutations.type\";\r\n\r\n\r\n\r\nfunction handleResponse(response) {\r\n  if (response.status === 204) {\r\n    return \"\";\r\n  } else if (response.status === 401) {\r\n    // Prevents mutliple simultaneous refreshes\r\n    if (!user.state.refreshingInProgress) {\r\n      console.log('requesting token refresh');\r\n      console.log(response);\r\n      store.commit(SET_REFRESHING_IN_PROGRESS, store.dispatch(REFRESH_ACCESS_TOKEN));\r\n    } else {\r\n      console.log('blocked. token request in progress')\r\n    }\r\n  } else {\r\n    return response.json().then(json => {\r\n      return response.ok ? json : Promise.reject(json);\r\n    })\r\n  }\r\n}\r\n\r\nfunction apiService(endpoint, method, data) {\r\n  const config = {\r\n    method: method || \"GET\",\r\n    body: data !== undefined ? JSON.stringify(data) : null,\r\n    headers: {\r\n      \"content-type\": \"application/json\",\r\n      \"X-CSRFTOKEN\": CSRF_TOKEN,\r\n      \"Authorization\": `Bearer ${user.state.accessToken}`,\r\n    }\r\n  };\r\n    return fetch(endpoint, config)\r\n      .then(handleResponse)\r\n}\r\n\r\nexport { apiService };\r\n\r\nexport const ScenarioService = {\r\n  // list() {\r\n  //   return apiService(`/api/scenarios/`, \"GET\");\r\n  // },\r\n  get(scenarioId) {\r\n    return apiService(`/api/scenarios/${scenarioId}/`, \"GET\");\r\n  },\r\n  create(scenario) {\r\n    return apiService(`/api/scenarios/`, \"POST\", scenario);\r\n  },\r\n  update(scenario) {\r\n    return apiService(`/api/scenarios/${scenario.id}/`, \"PATCH\", scenario);\r\n  },\r\n  // destroy(scenarioId) {\r\n  //   return apiService(`/api/scenarios/${scenarioId}/`, \"DELETE\");\r\n  // }\r\n};\r\n\r\nexport const AdvertService = {\r\n  list() {\r\n    return apiService(`/api/currentadvert/`, \"GET\");\r\n  },\r\n};\r\n\r\nexport const InvestmentNameService = {\r\n  list() {\r\n    return apiService(`/api/unlinkedinvestmentname/`, \"GET\");\r\n  },\r\n};\r\n\r\nexport const PlatformService = {\r\n  get({scenarioId, platformId}) {\r\n    return apiService(`/api/scenarios/${scenarioId}/platforms/${platformId}/`, \"GET\");\r\n  },\r\n  update(state, rootState) {\r\n    return apiService(`/api/scenarios/${rootState.scenario.activeScenario.id}/platforms/${state.activePlatform.id}/`, \"PATCH\", state.activePlatform);\r\n  },\r\n};\r\nexport const PlatformAAService = {\r\n  list({scenarioId, platformId}) {\r\n    return apiService(`/api/scenarios/${scenarioId}/platforms/${platformId}/aasummary/`, \"GET\");\r\n  },\r\n};\r\n\r\nexport const PlatformNameService = {\r\n  list(endpoint) {\r\n    if (endpoint) {\r\n      return apiService(endpoint, \"GET\");\r\n    } else {\r\n      return apiService(`/api/platformnames/`, \"GET\");\r\n    }\r\n  },\r\n};\r\n\r\nexport const UserService = {\r\n  get() {\r\n    return apiService(`/api/user/`, \"GET\");\r\n  },\r\n  update(user) {\r\n    return apiService(`/api/user/${user.id}/`, \"PATCH\", user);\r\n  },\r\n  login(credentials) {\r\n    return apiService(`/api/token/`, \"POST\", credentials);\r\n  },\r\n  refreshToken(refreshToken) {\r\n    console.log('token refreshing..')\r\n    return apiService(`/api/token/refresh/`, \"POST\", refreshToken);\r\n  },\r\n};\r\n"]}]}